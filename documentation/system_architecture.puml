@startuml system_architecture

' Use modern style
skinparam monochrome false
skinparam shadowing false
skinparam defaultFontName Arial
skinparam backgroundColor white
skinparam handwritten false

' Components
rectangle "Frontend (React + TypeScript)" {
    [React Components] as RC
    [API Client] as AC
    [WebSocket Client] as WC
    [State Management] as SM
}

rectangle "Backend (Spring Boot)" {
    [Controllers] as CTRL
    [Services] as SVC
    [Repositories] as REPO
    [Security] as SEC
    [WebSocket Handler] as WSH
}

cloud {
    [Clerk Auth] as CLERK
}

database "PostgreSQL" as DB

actor User as USER

' Connections
USER --> RC : Interacts
RC --> SM : Updates State
SM --> AC : Triggers API Calls
SM --> WC : WebSocket Communication

AC --> CTRL : REST API Calls
WC --> WSH : WebSocket Messages

CTRL --> SVC : Business Logic
SVC --> REPO : Data Access
REPO --> DB : Persistence

SEC --> CLERK : Authentication
CTRL ..> SEC : Security Check
WSH ..> SEC : Security Check

note right of CLERK
  Handles:
  - User Authentication
  - Session Management
  - User Management
end note

note right of DB
  Stores:
  - User Data
  - Channels
  - Messages
  - Files
end note

@enduml 